client:745 WebSocket connection to 'wss://4bfb526c-f8d6-4438-8e29-eb9805353be8-00-rybydy69e9r8.janeway.replit.dev/?token=Ly-XvbzdLtKy' failed: 
createConnection @ client:745
connect @ client:411
connect @ client:751
connect @ client:289
connect @ client:373
(anonymous) @ client:823
client:772 [vite] failed to connect to websocket (Error: WebSocket closed without opened.). 
connect @ client:772
await in connect
connect @ client:289
connect @ client:373
(anonymous) @ client:823
client:423 Uncaught (in promise) Error: WebSocket closed without opened.
    at WebSocket.<anonymous> (client:423:30)
(anonymous) @ client:423
react-dom_client.js?v=453f8220:20103 Download the React DevTools for a better development experience: https://react.dev/link/react-devtools
config.js:51 ✅ OpenAI API configured successfully
config.js:52    Key prefix: sk-proj...
config.js:53    Key length: 164 characters
App.jsx:93 Loaded 32731 cards into database
App.jsx:93 Loaded 32731 cards into database
App.jsx:241 Deck Strategy Analysis: {success: true, timestamp: '2025-10-31T07:07:11.455Z', analysis: {…}, metadata: {…}}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
activatedAbilityEngine.js:116 [parseActivatedAbilities] Detected landcycling: Lórien Revealed → Island (cost: {1})
activatedAbilityEngine.js:70 [parseActivatedAbilities] Detected fetch land: Evolving Wilds
activatedAbilityEngine.js:116 [parseActivatedAbilities] Detected landcycling: Lórien Revealed → Island (cost: {1})
enhancedStepByStepGame.js:675 🔍 Creating deck behavior manifest...
cardBehaviorAnalyzer.js:705 🔍 [PARSER] Commander's Sphere oracle text: {T}: Add one mana of any color in your commander's color identity.\nSacrifice this artifact: Draw a card.
cardBehaviorAnalyzer.js:706 🔍 [PARSER] Split into 2 lines
cardBehaviorAnalyzer.js:708 🔍 [PARSER]   Line 0: {T}: Add one mana of any color in your commander's color identity.
cardBehaviorAnalyzer.js:708 🔍 [PARSER]   Line 1: Sacrifice this artifact: Draw a card.
cardBehaviorAnalyzer.js:731 🔍 [PARSER] Commander's Sphere - Successfully parsed ability: {
  "abilityText": "{T}: Add one mana of any color in your commander's color identity.",
  "isManaAbility": true,
  "activationCost": [
    "{T}"
  ],
  "produces": [
    {
      "quantity": 1,
      "types": [
        {
          "choice": [
            "W",
            "U",
            "B",
            "R",
            "G"
          ],
          "restriction": "commander_identity"
        }
      ]
    }
  ]
}
cardBehaviorAnalyzer.js:705 🔍 [PARSER] Sol Ring oracle text: {T}: Add {C}{C}.
cardBehaviorAnalyzer.js:706 🔍 [PARSER] Split into 1 lines
cardBehaviorAnalyzer.js:708 🔍 [PARSER]   Line 0: {T}: Add {C}{C}.
cardBehaviorAnalyzer.js:705 🔍 [PARSER] Underground River oracle text: {T}: Add {C}.\n{T}: Add {U} or {B}. This land deals 1 damage to you.
cardBehaviorAnalyzer.js:706 🔍 [PARSER] Split into 2 lines
cardBehaviorAnalyzer.js:708 🔍 [PARSER]   Line 0: {T}: Add {C}.
cardBehaviorAnalyzer.js:708 🔍 [PARSER]   Line 1: {T}: Add {U} or {B}. This land deals 1 damage to you.
enhancedStepByStepGame.js:708 ✅ Behavior manifest created: {totalManaProducers: 22, totalFetchLands: 1, totalTokenGenerators: 12, totalCardDraw: 21}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
enhancedStepByStepGame.js:1880 🔍 [untap] BEFORE generateMana - Expected: 0 (lands:0 + artifacts:0 + creatures:0)
enhancedStepByStepGame.js:1881 🔍 [untap] Land count: 0, Artifact count: 0, Creature count: 0
gameEngine.js:505 🔍 [generateMana] Starting - Turn 1
gameEngine.js:506 🔍 [generateMana] Battlefield: 0 lands, 0 artifacts, 0 creatures
manaPool.js:554 
💎 [PotentialPool] Building available sources...
manaPool.js:644 💎 [PotentialPool] Found 0 available mana abilities
gameEngine.js:572 🔍 [generateMana] Final total: 0 available sources
gameEngine.js:573 🔍 [generateMana] Preview flexibility: {W: 0, U: 0, B: 0, R: 0, G: 0, …}
enhancedStepByStepGame.js:1889 🔍 [untap] AFTER generateMana - Expected: 0, Actual: 0
eventSystem.js:169 📤 Event Emitted: PHASE_CHANGED {source: 'unknown', queueSize: 1}
eventSystem.js:169 📤 Event Emitted: CARD_DRAWN {source: 'Watery Grave', queueSize: 1}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:554 
💎 [PotentialPool] Building available sources...
manaPool.js:644 💎 [PotentialPool] Found 1 available mana abilities
manaPool.js:647    0: Command Tower (land) → 1x{W/U/B/R/G}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {1}
manaPool.js:686 🧮 [ManaSolver] Available sources: 1 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 1}
manaPool.js:754    ✓ Using Command Tower for generic (producing {W})
manaPool.js:757 ✅ [ManaSolver] Found solution using 1 sources
manaPool.js:404 🔍 [canPay] Checking "{1}": YES ✅
gameEngine.js:1000 
🎯 [castSpell] Attempting to cast Sol Ring
gameEngine.js:1001 🎯 [castSpell] Cost: {1}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {1}
manaPool.js:686 🧮 [ManaSolver] Available sources: 1 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 1}
manaPool.js:754    ✓ Using Command Tower for generic (producing {W})
manaPool.js:757 ✅ [ManaSolver] Found solution using 1 sources
gameEngine.js:1017 ✅ [castSpell] Solution found! Tapping 1 sources
gameEngine.js:1022    🔒 Tapped Command Tower (produced {W})
manaPool.js:554 
💎 [PotentialPool] Building available sources...
manaPool.js:644 💎 [PotentialPool] Found 0 available mana abilities
eventSystem.js:169 📤 Event Emitted: SPELL_CAST {source: 'Sol Ring', queueSize: 1}
eventSystem.js:169 📤 Event Emitted: PERMANENT_ENTERS_BATTLEFIELD {source: 'Sol Ring', queueSize: 2}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
enhancedStepByStepGame.js:1880 🔍 [untap] BEFORE generateMana - Expected: 3 (lands:1 + artifacts:2 + creatures:0)
enhancedStepByStepGame.js:1881 🔍 [untap] Land count: 1, Artifact count: 1, Creature count: 0
gameEngine.js:505 🔍 [generateMana] Starting - Turn 2
gameEngine.js:506 🔍 [generateMana] Battlefield: 1 lands, 1 artifacts, 0 creatures
manaPool.js:554 
💎 [PotentialPool] Building available sources...
manaPool.js:644 💎 [PotentialPool] Found 2 available mana abilities
manaPool.js:647    0: Command Tower (land) → 1x{W/U/B/R/G}
manaPool.js:647    1: Sol Ring (artifact) → 2x{C}{C}
gameEngine.js:572 🔍 [generateMana] Final total: 5 available sources
gameEngine.js:573 🔍 [generateMana] Preview flexibility: {W: 1, U: 1, B: 1, R: 1, G: 1, …}
enhancedStepByStepGame.js:1889 🔍 [untap] AFTER generateMana - Expected: 3, Actual: 5
eventSystem.js:169 📤 Event Emitted: PHASE_CHANGED {source: 'unknown', queueSize: 1}
eventSystem.js:169 📤 Event Emitted: CARD_DRAWN {source: 'Palantír of Orthanc', queueSize: 1}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:554 
💎 [PotentialPool] Building available sources...
manaPool.js:644 💎 [PotentialPool] Found 2 available mana abilities
manaPool.js:647    0: Command Tower (land) → 1x{W/U/B/R/G}
manaPool.js:647    1: Sol Ring (artifact) → 2x{C}{C}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 2 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:717 ❌ [ManaSolver] Cannot find source for {B}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 2 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:717 ❌ [ManaSolver] Cannot find source for {B}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 2 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:717 ❌ [ManaSolver] Cannot find source for {B}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 2 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:717 ❌ [ManaSolver] Cannot find source for {B}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
enhancedStepByStepGame.js:1880 🔍 [untap] BEFORE generateMana - Expected: 4 (lands:2 + artifacts:2 + creatures:0)
enhancedStepByStepGame.js:1881 🔍 [untap] Land count: 2, Artifact count: 1, Creature count: 0
gameEngine.js:505 🔍 [generateMana] Starting - Turn 3
gameEngine.js:506 🔍 [generateMana] Battlefield: 2 lands, 1 artifacts, 0 creatures
manaPool.js:554 
💎 [PotentialPool] Building available sources...
manaPool.js:644 💎 [PotentialPool] Found 3 available mana abilities
manaPool.js:647    0: Command Tower (land) → 1x{W/U/B/R/G}
manaPool.js:647    1: Watery Grave (land) → 1x{U/B}
manaPool.js:647    2: Sol Ring (artifact) → 2x{C}{C}
gameEngine.js:572 🔍 [generateMana] Final total: 6 available sources
gameEngine.js:573 🔍 [generateMana] Preview flexibility: {W: 1, U: 2, B: 2, R: 1, G: 1, …}
enhancedStepByStepGame.js:1889 🔍 [untap] AFTER generateMana - Expected: 4, Actual: 6
eventSystem.js:169 📤 Event Emitted: PHASE_CHANGED {source: 'unknown', queueSize: 1}
eventSystem.js:169 📤 Event Emitted: CARD_DRAWN {source: 'Birthday Escape', queueSize: 1}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:554 
💎 [PotentialPool] Building available sources...
manaPool.js:644 💎 [PotentialPool] Found 4 available mana abilities
manaPool.js:647    0: Command Tower (land) → 1x{W/U/B/R/G}
manaPool.js:647    1: Watery Grave (land) → 1x{U/B}
manaPool.js:647    2: Sunken Ruins (land) → 1x{C}
manaPool.js:647    3: Sol Ring (artifact) → 2x{C}{C}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 4 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:730    ✓ Using Watery Grave for {B}
manaPool.js:754    ✓ Using Sunken Ruins for generic (producing {C})
manaPool.js:754    ✓ Using Sol Ring for generic (producing {C})
manaPool.js:739 ❌ [ManaSolver] Cannot find source for generic {1}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 4 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:730    ✓ Using Watery Grave for {B}
manaPool.js:754    ✓ Using Sunken Ruins for generic (producing {C})
manaPool.js:754    ✓ Using Sol Ring for generic (producing {C})
manaPool.js:739 ❌ [ManaSolver] Cannot find source for generic {1}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 4 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:730    ✓ Using Watery Grave for {B}
manaPool.js:754    ✓ Using Sunken Ruins for generic (producing {C})
manaPool.js:754    ✓ Using Sol Ring for generic (producing {C})
manaPool.js:739 ❌ [ManaSolver] Cannot find source for generic {1}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 4 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:730    ✓ Using Watery Grave for {B}
manaPool.js:754    ✓ Using Sunken Ruins for generic (producing {C})
manaPool.js:754    ✓ Using Sol Ring for generic (producing {C})
manaPool.js:739 ❌ [ManaSolver] Cannot find source for generic {1}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
enhancedStepByStepGame.js:1880 🔍 [untap] BEFORE generateMana - Expected: 5 (lands:3 + artifacts:2 + creatures:0)
enhancedStepByStepGame.js:1881 🔍 [untap] Land count: 3, Artifact count: 1, Creature count: 0
gameEngine.js:505 🔍 [generateMana] Starting - Turn 4
gameEngine.js:506 🔍 [generateMana] Battlefield: 3 lands, 1 artifacts, 0 creatures
manaPool.js:554 
💎 [PotentialPool] Building available sources...
manaPool.js:644 💎 [PotentialPool] Found 4 available mana abilities
manaPool.js:647    0: Command Tower (land) → 1x{W/U/B/R/G}
manaPool.js:647    1: Watery Grave (land) → 1x{U/B}
manaPool.js:647    2: Sunken Ruins (land) → 1x{C}
manaPool.js:647    3: Sol Ring (artifact) → 2x{C}{C}
gameEngine.js:572 🔍 [generateMana] Final total: 7 available sources
gameEngine.js:573 🔍 [generateMana] Preview flexibility: {W: 1, U: 2, B: 2, R: 1, G: 1, …}
enhancedStepByStepGame.js:1889 🔍 [untap] AFTER generateMana - Expected: 5, Actual: 7
eventSystem.js:169 📤 Event Emitted: PHASE_CHANGED {source: 'unknown', queueSize: 1}
eventSystem.js:169 📤 Event Emitted: CARD_DRAWN {source: 'Barad-dûr', queueSize: 1}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:554 
💎 [PotentialPool] Building available sources...
manaPool.js:644 💎 [PotentialPool] Found 4 available mana abilities
manaPool.js:647    0: Command Tower (land) → 1x{W/U/B/R/G}
manaPool.js:647    1: Watery Grave (land) → 1x{U/B}
manaPool.js:647    2: Sunken Ruins (land) → 1x{C}
manaPool.js:647    3: Sol Ring (artifact) → 2x{C}{C}
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 4 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:730    ✓ Using Watery Grave for {B}
manaPool.js:754    ✓ Using Sunken Ruins for generic (producing {C})
manaPool.js:754    ✓ Using Sol Ring for generic (producing {C})
manaPool.js:739 ❌ [ManaSolver] Cannot find source for generic {1}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 4 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:730    ✓ Using Watery Grave for {B}
manaPool.js:754    ✓ Using Sunken Ruins for generic (producing {C})
manaPool.js:754    ✓ Using Sol Ring for generic (producing {C})
manaPool.js:739 ❌ [ManaSolver] Cannot find source for generic {1}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 4 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:730    ✓ Using Watery Grave for {B}
manaPool.js:754    ✓ Using Sunken Ruins for generic (producing {C})
manaPool.js:754    ✓ Using Sol Ring for generic (producing {C})
manaPool.js:739 ❌ [ManaSolver] Cannot find source for generic {1}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
apiClient.js:83 API Response received: {model: 'gpt-5-mini-2025-08-07', finishReason: 'stop', hasContent: true}
manaPool.js:685 
🧮 [ManaSolver] Solving cost: {3}{U}{B}
manaPool.js:686 🧮 [ManaSolver] Available sources: 4 abilities
manaPool.js:690 🧮 [ManaSolver] Required: {colored: {…}, generic: 3}
manaPool.js:730    ✓ Using Command Tower for {U}
manaPool.js:730    ✓ Using Watery Grave for {B}
manaPool.js:754    ✓ Using Sunken Ruins for generic (producing {C})
manaPool.js:754    ✓ Using Sol Ring for generic (producing {C})
manaPool.js:739 ❌ [ManaSolver] Cannot find source for generic {1}
manaPool.js:404 🔍 [canPay] Checking "{3}{U}{B}": NO ❌
enhancedStepByStepGame.js:1880 🔍 [untap] BEFORE generateMana - Expected: 6 (lands:4 + artifacts:2 + creatures:0)
enhancedStepByStepGame.js:1881 🔍 [untap] Land count: 4, Artifact count: 1, Creature count: 0
gameEngine.js:505 🔍 [generateMana] Starting - Turn 5
gameEngine.js:506 🔍 [generateMana] Battlefield: 4 lands, 1 artifacts, 0 creatures
manaPool.js:554 
💎 [PotentialPool] Building available sources...
manaPool.js:644 💎 [PotentialPool] Found 5 available mana abilities
manaPool.js:647    0: Command Tower (land) → 1x{W/U/B/R/G}
manaPool.js:647    1: Watery Grave (land) → 1x{U/B}
manaPool.js:647    2: Sunken Ruins (land) → 1x{C}
manaPool.js:647    3: Barad-dûr (land) → 1x{B}
manaPool.js:647    4: Sol Ring (artifact) → 2x{C}{C}
gameEngine.js:572 🔍 [generateMana] Final total: 8 available sources
gameEngine.js:573 🔍 [generateMana] Preview flexibility: {W: 1, U: 2, B: 3, R: 1, G: 1, …}
enhancedStepByStepGame.js:1889 🔍 [untap] AFTER generateMana - Expected: 6, Actual: 8
eventSystem.js:169 📤 Event Emitted: PHASE_CHANGED {source: 'unknown', queueSize: 1}
eventSystem.js:169 📤 Event Emitted: CARD_DRAWN {source: 'Stern Scolding', queueSize: 1}